<html>
    <head>
        <script src="./WebGazer/www/webgazer.js"></script>
    </head>
    <body>
        <div style="text-align: right;">
            <p id="gazeData"></p>
            <button style="text-align: right;" id="exportBtn">Export to CSV</button>
        </div>
        <script>
            webgazer.resume();

            const gazeData = []
            webgazer.setGazeListener(function(data, elapsedTime) {
                if (data != null) {
                    var x = data.x;
                    var y = data.y;
                    gazeData.push([elapsedTime, x, y]);
                    document.getElementById("gazeData").innerHTML = "Gaze coordinates: x=" + x + ", y=" + y;
                    console.log(gazeData)
                }
            }).begin();
            const exportBtn = document.getElementById("exportBtn");
            exportBtn.addEventListener("click", () => {
                // Create a CSV string from the gaze data
                const csvString = gazeData.map(row => row.join(",")).join("\n");

                // Create a CSV file and download it
                const blob = new Blob([csvString], { type: "text/csv;charset=utf-8;" });
                const url = URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.setAttribute("href", url);
                link.setAttribute("download", "gazeData.csv");
                link.style.display = "none";
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        </script>
        <style>
            html, body {height: 100%;margin: 0; padding: 0;}
            table {width: 100%; height: 100%;border-collapse: collapse;}
            td {border: 1px solid black;}
        </style>
    
        <table>
            <tr>
                <td>Cell 1</td>
                <td>Cell 2</td>
                <td>Cell 3</td>
            </tr>
            <tr>
                <td>Cell 4</td>
                <td>Cell 5</td>
                <td>Cell 6</td>
            </tr>
            <tr>
                <td>Cell 7</td>
                <td>Cell 8</td>
                <td>Cell 9</td>
            </tr>
        </table>

    </body>
</html>